<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="10/13/2025 6:12:12 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DESKTOP-OOETEMG"
  DTS:CreatorName="DESKTOP-OOETEMG\Anu"
  DTS:DTSID="{201F9B93-7524-47CD-842F-84928A58AE26}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5685.2"
  DTS:LocaleID="1033"
  DTS:ObjectName="Package1"
  DTS:PackageType="5"
  DTS:VersionBuild="62"
  DTS:VersionGUID="{A7B76F5A-AB60-40EA-BAA5-F5D758F5884F}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{71630388-6516-40C7-A580-2F09D2604EE3}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{249DE10A-D865-4592-A049-BBB588EE2C61}"
          SQLTask:SqlStatementSource="/*==========================================================&#xA;  ETL: Full Reload of abc_dwh.DimDate (2006–2026)&#xA;  - Deterministic weekday &amp; names (no DATEFIRST/LANGUAGE deps)&#xA;  - Sunday = 1 … Saturday = 7&#xA;  - WeekNumber = Sunday-based&#xA;  - Fiscal parts configurable via @FiscalStartMonth&#xA;==========================================================*/&#xA;SET NOCOUNT ON;&#xA;SET XACT_ABORT ON;&#xA;&#xA;BEGIN TRAN;&#xA;&#xA;DECLARE @StartDate        date = '2006-01-01';&#xA;DECLARE @EndDate          date = '2026-12-31';&#xA;DECLARE @FiscalStartMonth int  = 1;   -- e.g., 4 for April fiscal start&#xA;&#xA;-- 1) Empty table (use DELETE WITH (TABLOCK) if FK refs block TRUNCATE)&#xA;DELETE abc_dwh.DimDate;&#xA;---TRUNCATE TABLE abc_dwh.DimDate; if needed&#xA;&#xA;-- 2) Build tally → dates → calc, then insert&#xA;;WITH&#xA;E1(N) AS (SELECT 1 FROM (VALUES(1),(1),(1),(1),(1),(1),(1),(1),(1),(1)) v(n)),  -- 10&#xA;E2(N) AS (SELECT 1 FROM E1 a CROSS JOIN E1 b),                                   -- 100&#xA;E4(N) AS (SELECT 1 FROM E2 a CROSS JOIN E2 b),                                   -- 10,000&#xA;Tally(N) AS (&#xA;    SELECT TOP (DATEDIFF(DAY, @StartDate, @EndDate) + 1)&#xA;           ROW_NUMBER() OVER (ORDER BY (SELECT 1)) - 1&#xA;    FROM E4&#xA;),&#xA;Dates AS (&#xA;    SELECT DATEADD(DAY, N, @StartDate) AS FullDate&#xA;    FROM Tally&#xA;),&#xA;Calc AS (&#xA;    SELECT&#xA;        d.FullDate,&#xA;        -- Deterministic DayOfWeek: 1=Sun … 7=Sat (anchor Sunday 2000-01-02)&#xA;        (((DATEDIFF(DAY, CONVERT(date,'2000-01-02'), d.FullDate) % 7) + 7) % 7) + 1 AS DayOfWeek,&#xA;        -- Sunday-based week number&#xA;        DATEDIFF(WEEK, DATEADD(DAY,-1, DATEFROMPARTS(YEAR(d.FullDate),1,1)), d.FullDate)  AS WeekNumber,&#xA;        DAY(d.FullDate)                         AS DayOfMonth,&#xA;        DATEPART(DAYOFYEAR, d.FullDate)         AS DayOfYear,&#xA;        MONTH(d.FullDate)                       AS MonthOfYear,&#xA;        DATEPART(QUARTER, d.FullDate)           AS CalendarQuarter,&#xA;        YEAR(d.FullDate)                        AS CalendarYear,&#xA;        -- Shift for fiscal calculations&#xA;        DATEADD(MONTH, -( @FiscalStartMonth - 1 ), d.FullDate) AS ShiftedFiscalDate&#xA;    FROM Dates d&#xA;)&#xA;INSERT INTO abc_dwh.DimDate&#xA;(&#xA;    DateKey,&#xA;    FullDate,&#xA;    DayOfWeek,&#xA;    DayName,&#xA;    DayOfMonth,&#xA;    DayOfYear,&#xA;    WeekNumber,&#xA;    MonthOfYear,&#xA;    MonthName,&#xA;    CalendarQuarter,&#xA;    CalendarYear,&#xA;    IsWeekend,&#xA;    FiscalMonth,&#xA;    FiscalQuarter,&#xA;    FiscalYear&#xA;)&#xA;SELECT&#xA;    (YEAR(c.FullDate) * 10000) + (MONTH(c.FullDate) * 100) + DAY(c.FullDate) AS DateKey,&#xA;    c.FullDate,&#xA;    c.DayOfWeek,&#xA;    CASE c.DayOfWeek&#xA;        WHEN 1 THEN 'Sunday' WHEN 2 THEN 'Monday' WHEN 3 THEN 'Tuesday'&#xA;        WHEN 4 THEN 'Wednesday' WHEN 5 THEN 'Thursday' WHEN 6 THEN 'Friday'&#xA;        ELSE 'Saturday'&#xA;    END AS DayName,&#xA;    c.DayOfMonth,&#xA;    c.DayOfYear,&#xA;    c.WeekNumber,&#xA;    c.MonthOfYear,&#xA;    CASE c.MonthOfYear&#xA;        WHEN 1 THEN 'January'  WHEN 2 THEN 'February' WHEN 3 THEN 'March'&#xA;        WHEN 4 THEN 'April'    WHEN 5 THEN 'May'      WHEN 6 THEN 'June'&#xA;        WHEN 7 THEN 'July'     WHEN 8 THEN 'August'   WHEN 9 THEN 'September'&#xA;        WHEN 10 THEN 'October' WHEN 11 THEN 'November' WHEN 12 THEN 'December'&#xA;    END AS MonthName,&#xA;    c.CalendarQuarter,&#xA;    c.CalendarYear,&#xA;    CASE WHEN c.DayOfWeek IN (1,7) THEN 1 ELSE 0 END AS IsWeekend,&#xA;    MONTH(c.ShiftedFiscalDate)                 AS FiscalMonth,&#xA;    DATEPART(QUARTER, c.ShiftedFiscalDate)     AS FiscalQuarter,&#xA;    YEAR(c.ShiftedFiscalDate)                  AS FiscalYear&#xA;FROM Calc c;&#xA;&#xA;-- 3) Sanity check&#xA;DECLARE @Expected int = DATEDIFF(DAY, @StartDate, @EndDate) + 1;&#xA;DECLARE @Actual   int = (SELECT COUNT(*) FROM abc_dwh.DimDate);&#xA;IF (@Actual &lt;&gt; @Expected)&#xA;BEGIN&#xA;    RAISERROR('DimDate load mismatch: expected %d rows, got %d.', 16, 1, @Expected, @Actual);&#xA;END&#xA;&#xA;COMMIT TRAN;&#xA;&#xA;PRINT CONCAT('DimDate full reload complete. Rows inserted: ', @Actual);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="170,42"
          Id="Package\Execute SQL Task"
          TopLeft="192,174" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>